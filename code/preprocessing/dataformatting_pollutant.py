import pandas as pd

# Read the input file with the correct delimiter and encoding
df = pd.read_csv('../../dataset/AIR_EMISSIONS_04052024055348361.csv', delimiter=',', encoding='ISO-8859-1')

# Create a pivot table to transform the data
pivot_table = df.pivot_table(index=['Year', 'Country'], columns='POL', values='Value')

# Reset the index to flatten the multi-index
pivot_table.reset_index(inplace=True)

# Rename columns
pivot_table.columns.name = None

# Save the result to a new CSV file
pivot_table.to_csv('./intermediate files/formatted_file.csv', index=False)
