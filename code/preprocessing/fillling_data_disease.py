import pandas as pd
import numpy as np

# Load the CSV file into a DataFrame
df = pd.read_csv('../../dataset/Annual Death dataset.csv')
for disease in df.columns[2:]:
    for country in df['Entity'].unique():
        # Filter data for the specific disease and country
        subset = df[(df['Entity'] == country)][['Year', disease]]
        
        # Check if there are non-zero values and not for all non-zero values
        if subset[disease].ne(0).any() and not subset[disease].ne(0).all():
             # Calculate mean for available years and put it in 1990
             mean_available_years = subset.loc[subset[disease] != 0, disease].mean()
             subset.loc[subset['Year'] == 1990, disease] = mean_available_years

    
        # Replace zeros with NaN for forward filling
        subset.loc[subset[disease] == 0, disease] = float('nan')
        # Replace NaN values with forward filling
        subset[disease] = subset[disease].fillna(method='ffill')
        
        # Update the original DataFrame with the modified subset
        df.update(subset)

# Step 3: Save the modified DataFrame if needed
df.to_csv('./intermediate files/preprocessed_disease_dataset.csv', index=False)